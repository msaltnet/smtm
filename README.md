# smtm
[![build status](https://github.com/msaltnet/smtm/actions/workflows/python-test.yml/badge.svg)](https://github.com/msaltnet/smtm/actions/workflows/python-test.yml)
[![license](https://img.shields.io/github/license/msaltnet/smtm.svg?style=flat-square)](https://github.com/msaltnet/smtm/blob/master/LICENSE)
![language](https://img.shields.io/github/languages/top/msaltnet/smtm.svg?style=flat-square&colorB=green)
[![codecov](https://codecov.io/gh/msaltnet/smtm/branch/master/graph/badge.svg?token=USXTX7MG70)](https://codecov.io/gh/msaltnet/smtm)

> It's a game to get money. 

íŒŒì´ì¬ ì•Œê³ ë¦¬ì¦˜ê¸°ë°˜ ì•”í˜¸í™”í ìžë™ë§¤ë§¤ í”„ë¡œê·¸ëž¨. https://smtm.msalt.net

[êµë³´ë¬¸ê³  - ì•”í˜¸í™”í ìžë™ë§¤ë§¤ ì‹œìŠ¤í…œ ë§Œë“¤ê¸° with íŒŒì´ì¬](http://www.kyobobook.co.kr/product/detailViewKor.laf?mallGb=KOR&ejkGb=KOR&barcode=9788997924967)

[ì˜ˆìŠ¤24 - ì•”í˜¸í™”í ìžë™ë§¤ë§¤ ì‹œìŠ¤í…œ ë§Œë“¤ê¸° with íŒŒì´ì¬](http://www.yes24.com/Product/Goods/107635612)

[ì•Œë¼ë”˜ - ì•”í˜¸í™”í ìžë™ë§¤ë§¤ ì‹œìŠ¤í…œ ë§Œë“¤ê¸° with íŒŒì´ì¬](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=289526248)

[English](https://github.com/msaltnet/smtm/blob/master/README-en_us.md) ðŸ‘ˆ

[![icon_wide_gold](https://user-images.githubusercontent.com/9311990/161744914-05e3d116-0e9b-447f-a015-136e0b9ec22b.png)](https://smtm.msalt.net/)


ë°ì´í„° ìˆ˜ì§‘ -> ì•Œê³ ë¦¬ì¦˜ ë¶„ì„ -> ê±°ëž˜ë¡œ ì´ë£¨ì–´ì§„ ê°„ë‹¨í•œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì •í•´ì§„ ê°„ê²©ìœ¼ë¡œ ë°˜ë³µ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ê¸°ë³¸ ê°œë…ì´ë©°, ê¸°ë³¸ì ìœ¼ë¡œ ë¶„ë‹¹ 1íšŒ í”„ë¡œì„¸ìŠ¤ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ê²€ì¦ë˜ì—ˆìŠµë‹ˆë‹¤.

1. Data Provider ëª¨ë“ˆì´ ë°ì´í„° ì·¨í•©  
2. Strategy ëª¨ë“ˆì„ í†µí•œ ì•Œê³ ë¦¬ì¦˜ ë§¤ë§¤ íŒë‹¨  
3. Trader ëª¨ë“ˆì„ í†µí•œ ê±°ëž˜ ì²˜ë¦¬  
 --- ë°˜ë³µ ---
4. Analyzer ëª¨ë“ˆì„ í†µí•œ ë¶„ì„

â— ì´ˆ ë‹¨ìœ„ì˜ ì§§ì€ ì‹œê°„ì— ë§Žì€ ê±°ëž˜ë¥¼ ì²˜ë¦¬í•´ì•¼í•˜ëŠ” ê³ ì„±ëŠ¥ íŠ¸ë ˆì´ë”© ë¨¸ì‹ ìœ¼ë¡œëŠ” ì í•©í•˜ì§€ ì•Šìœ¼ë©°, ì²˜ë¦¬ ì‹œê°„ì´ ì¤‘ìš”í•œ ì„±ëŠ¥ì´ ìš”êµ¬ë˜ëŠ” ê²½ìš° ì¶©ë¶„í•œ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.

![intro](https://user-images.githubusercontent.com/9311990/140635409-93e4b678-5a6b-40b8-8e28-5c8f819aa88c.jpg)

## ì£¼ìš”ê¸°ëŠ¥
- íŒŒë¼ë¯¸í„°ë¥¼ ì„¤ì • ê°€ëŠ¥í•œ ì‹œë®¬ë ˆì´ì…˜
- ë©€í‹°í”„ë¡œì„¸ìŠ¤ ëŒ€ëŸ‰ì‹œë®¬ë ˆì´ì…˜
- CLI ëª¨ë“œ ìžë™ ê±°ëž˜ í”„ë¡œê·¸ëž¨
- JupyterNotebookì„ í™œìš©í•œ ì›ê²©ì»¨íŠ¸ë¡¤
- í…”ë ˆê·¸ëž¨ìœ¼ë¡œ ì»¨íŠ¸ë¡¤ í•˜ëŠ” ìžë™ê±°ëž˜ í”„ë¡œê·¸ëž¨

### í…”ë ˆê·¸ëž¨ ì±—ë´‡ ëª¨ë“œ
í…”ë ˆê·¸ëž¨ ì±—ë´‡ ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ë©´ ìžë™ë§¤ë§¤ í”„ë¡œê·¸ëž¨ì„ í…”ë ˆê·¸ëž¨ ë©”ì‹ ì €ë¥¼ ì‚¬ìš©í•´ì„œ ì»¨íŠ¸ë¡¤ í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

í…”ë ˆê·¸ëž¨ ì±—ë´‡ ëª¨ë“œë¥¼ ìœ„í•´ì„œëŠ” ì±—ë´‡ì„ ë§Œë“¤ê³  API í† í°ê³¼ ëŒ€í™”ë°© ì •ë³´ë¥¼ ìž…ë ¥í•´ì„œ êµ¬ë™í•´ì•¼ í•©ë‹ˆë‹¤.

![smtm_bot](https://user-images.githubusercontent.com/9311990/150667094-95139bfb-03e0-41d5-bad9-6be05ec6c9df.png)

![telegram_chatbot](https://user-images.githubusercontent.com/9311990/150663864-c5a7ed27-f1c6-4b87-8220-e31b8ccce368.PNG)

### ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œ
ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œì„ í†µí•´ ê³¼ê±° ê±°ëž˜ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ì„ ìˆ˜í–‰í•´ì„œ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. ê°„ë‹¨í•œ ì‹œë®¬ë ˆì´ì…˜ë¶€í„° ëŒ€ëŸ‰ì‹œë®¬ë ˆì´ì…˜ê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

## ì„¤ì¹˜ë°©ë²•
ì†ŒìŠ¤ ì½”ë“œë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ê´€ë ¨ëœ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”.

```
pip install -r requirements.txt
```

ì‹œìŠ¤í…œ ìˆ˜ì • ë° ê°œë°œì„ ì›í•  ë•ŒëŠ” -e ì˜µì…˜ìœ¼ë¡œ ê°œë°œê´€ë ¨ íŒ¨í‚¤ì§€ë„ ì„¤ì¹˜í•˜ì„¸ìš”.

```
pip install -r requirements-dev.txt
```

## ì‚¬ìš©ë°©ë²•
ì‹œë®¬ë ˆì´ì…˜, ëŒ€ëŸ‰ ì‹œë®¬ë ˆì´ì…˜, ì±—ë´‡ ëª¨ë“œë¥¼ í¬í•¨í•˜ì—¬ ì•„ëž˜ 6ê°œì˜ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

- 0: ì¸í„°ë ‰í‹°ë¸Œ ëª¨ë“œ ì‹œë®¬ë ˆì´í„°
- 1: ìž…ë ¥ë°›ì€ ì„¤ì •ê°’ìœ¼ë¡œ ì‹±ê¸€ ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰
- 2: ì¸í„°ë ‰í‹°ë¸Œ ëª¨ë“œ ê¸°ë³¸ ì‹¤ì „ ë§¤ë§¤ í”„ë¡œê·¸ëž¨
- 3: í…”ë ˆê·¸ëž¨ ì±—ë´‡ ëª¨ë“œë¡œ ì‹¤ì „ ë§¤ë§¤ í”„ë¡œê·¸ëž¨
- 4: ì»¨í”¼ê·¸ íŒŒì¼ì„ ì‚¬ìš©í•œ ëŒ€ëŸ‰ ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰
- 5: ëŒ€ëŸ‰ ì‹œë®¬ë ˆì´ì…˜ì„ ìœ„í•œ ì»¨í”¼ê·¸ íŒŒì¼ ìƒì„±

### ì¸í„°ë ‰í‹°ë¸Œ ëª¨ë“œ ì‹œë®¬ë ˆì´í„°
ì•„ëž˜ ëª…ë ¹ì–´ë¡œ ì¸í„°ë ‰í‹°ë¸Œ ëª¨ë“œ ì‹œë®¬ë ˆì´í„° ì‹¤í–‰.

```
python -m smtm --mode 0
```

### ì‹±ê¸€ ì‹œë®¬ë ˆì´ì…˜
ì‹œë®¬ë ˆì´ì…˜ íŒŒë¼ë¯¸í„°ì™€ í•¨ê»˜ ì•„ëž˜ ëª…ë ¹ì–´ë¡œ ë‹¨ì¼ ì‹œë®¬ë ˆì´ì…˜ì„ ì‹¤í–‰í•˜ë©´ ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```
python -m smtm --mode 1 --budget 500000 --from_dash_to 201220.080000-201221 --term 0.001 --strategy 1 --currency BTC
```

### ê¸°ë³¸ ì‹¤ì „ ë§¤ë§¤ í”„ë¡œê·¸ëž¨
ì•„ëž˜ ëª…ë ¹ì–´ë¡œ ì´ˆê¸°ê°’ê³¼ í•¨ê»˜ ê¸°ë³¸ ì‹¤ì „ ë§¤ë§¤ í”„ë¡œê·¸ëž¨ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ê¸°ë³¸ ì‹¤ì „ ë§¤ë§¤ í”„ë¡œê·¸ëž¨ì€ ì¸í„°ë ‰í‹°ë¸Œ ëª¨ë“œë¡œ ì‹¤í–‰ë˜ì–´ ìž…ë ¥ì— ë”°ë¼ ê±°ëž˜ ì‹œìž‘, ì¤‘ì§€, ê²°ê³¼ ì¡°íšŒê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```
python -m smtm --mode 2 --budget 100000 --term 60 --strategy 0 --currency ETH
```

ì‹¤ì „ ê±°ëž˜ë¥¼ ìœ„í•´ì„œëŠ” `.env` íŒŒì¼ì— ê±°ëž˜ì†Œ API KEYì™€ API host urlì„ ë„£ì–´ ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.

```
UPBIT_OPEN_API_ACCESS_KEY=Your API KEY
UPBIT_OPEN_API_SECRET_KEY=Your API KEY
UPBIT_OPEN_API_SERVER_URL=https://api.upbit.com
```

### í…”ë ˆê·¸ëž¨ ì±—ë´‡ ëª¨ë“œ ì‹¤ì „ ë§¤ë§¤ í”„ë¡œê·¸ëž¨
ì•„ëž˜ ëª…ë ¹ì–´ë¡œ í…”ë ˆê·¸ëž¨ ì±—ë´‡ ëª¨ë“œ ì‹¤ì „ ë§¤ë§¤ í”„ë¡œê·¸ëž¨ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. í…”ë ˆê·¸ëž¨ ì±—ë´‡ ëª¨ë“œ ì‹¤ì „ ë§¤ë§¤ í”„ë¡œê·¸ëž¨ì€ ìž…ë ¥ë°›ì€ í…”ë ˆê·¸ëž¨ ì±—ë´‡ API í† í°ê³¼ ëŒ€í™”ë°© ì •ë³´ë¥¼ ì‚¬ìš©í•˜ì—¬ í…”ë ˆê·¸ëž¨ ì±—ë´‡ ë©”ì„¸ì§€ë¥¼ í†µí•´ì„œ ê±°ëž˜ ì‹œìž‘, ì¤‘ì§€, ê²°ê³¼ ì¡°íšŒê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```
python -m smtm --mode 3
```

ì±—ë´‡ ëª¨ë“œë¥¼ ìœ„í•´ì„œëŠ” `.env` íŒŒì¼ì— í…”ë ˆê·¸ëž¨ ì±—ë´‡ API í† í°ê³¼ ì±—ë´‡ ëŒ€í™”ë°© ì•„ì´ë””ë¥¼ ë„£ì–´ ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.

```
TELEGRAM_BOT_TOKEN=bot123456789:YOUR bot Token
TELEGRAM_CHAT_ID=123456789
```

### ëŒ€ëŸ‰ ì‹œë®¬ë ˆì´ì…˜
ëŒ€ëŸ‰ ì‹œë®¬ë ˆì´ì…˜ ì„¤ì • íŒŒì¼ê³¼ í•¨ê»˜ ì‹¤í–‰í•©ë‹ˆë‹¤. ì„¤ì • íŒŒì¼ì„ json í˜•ì‹ì´ë©° í…ìŠ¤íŠ¸ íŽ¸ì§‘ê¸°ë¥¼ í†µí•´ì„œ ì§ì ‘ ìƒì„±í•´ë„ ë˜ê³ , ëª…ë ¹ì–´ë¥¼ í†µí•´ ìƒì„±ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```
python -m smtm --mode 4 --config /data/sma0_simulation.json
```

### ëŒ€ëŸ‰ ì‹œë®¬ë ˆì´ì…˜ ì„¤ì • íŒŒì¼ ìƒì„±
íŒŒë¼ë¯¸í„°ì™€ í•¨ê»˜ ì•„ëž˜ ëª…ë ¹ì–´ë¡œ ëŒ€ëŸ‰ ì‹œë®¬ë ˆì´ì…˜ì— ì‚¬ìš©ë  ì„¤ì • íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```
python -m smtm --mode 5 --budget 50000 --title SMA_6H_week --strategy 1 --currency ETH --from_dash_to 210804.000000-210811.000000 --offset 360 --file generated_config.json
```

## ì†Œí”„íŠ¸ì›¨ì–´ ì„¤ê³„êµ¬ì¡°
ê³„ì¸µí™”ëœ ì•„í‚¤í…ì³ Layered architecture

| Layer | Module | Role |
|:---:|:---:|:---:|
| Controller Layer | Simulator, Controller, TelegramController| User Interface |
| Operator Layer | Operator, SimulationOperator |Operating Manager |
| Core Layer |Analyzer, Trader, Strategy, Data Provider | Core Feature |

### Component Diagram

![Component Diagram](https://user-images.githubusercontent.com/9311990/221420624-9807ca39-31c7-4bb6-b3de-3a4114f22430.png)

### Class Diagram

![Class Diagram](https://user-images.githubusercontent.com/9311990/221420583-6b335aec-1547-47b3-8b64-6a6313127890.png)

### Sequence Diagram

![Sequence Diagram](https://user-images.githubusercontent.com/9311990/221420634-7ede859b-6b80-4b9d-9af2-0b04a0bfd9d3.png)


## í…ŒìŠ¤íŠ¸ ë°©ë²•
### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
unittestë¥¼ ì‚¬ìš©í•´ì„œ í”„ë¡œì íŠ¸ì˜ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰.

```
# run unittest directly
python -m unittest discover ./tests *test.py -v
```

### í†µí•© í…ŒìŠ¤íŠ¸
í†µí•© í…ŒìŠ¤íŠ¸ëŠ” ì‹¤ì œ ê±°ëž˜ì†Œë¥¼ ì‚¬ìš©í•´ì„œ í…ŒìŠ¤íŠ¸ê°€ ì§„í–‰ë©ë‹ˆë‹¤. ëª‡ëª‡ í…ŒìŠ¤íŠ¸ëŠ” ì£¼í”¼í„° ë…¸íŠ¸ë¶ì„ ì‚¬ìš©í•´ì„œ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤. `notebook` í´ë”ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”.

```
# run unittest directly
python -m unittest integration_tests

# or
python -m unittest integration_tests.simulation_ITG_test
```

### ê°œë°œíŒ
ì»¤ë°‹ì„ ìƒì„±í•˜ê¸° ì „ì— ì•„ëž˜ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ Jupyter notebookì˜ ì¶œë ¥ì„ ì‚­ì œí•˜ì„¸ìš”.

```bash
jupyter nbconvert --clear-output --inplace {file.ipynb}
#jupyter nbconvert --clear-output --inplace .\notebook\*.ipynb
```

ì‹œë®¬ë ˆì´ì…˜ì´ë‚˜ ë°ëª¨ ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, SimulationDataProviderëŠ” ì—…ë¹„íŠ¸ì˜ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ, ì‹œìŠ¤í…œ ì‹œê°„ì˜ íƒ€ìž„ì¡´ì´ í•œêµ­ìœ¼ë¡œ ì„¤ì •ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. íŠ¹ížˆ, í´ë¼ìš°íŠ¸ ë¦¬ëˆ…ìŠ¤ì˜ ê²½ìš° ì•„ëž˜ ëª…ë ¹ì–´ë¡œ ì„¤ì • í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```bash
timedatectl set-timezone 'Asia/Seoul'
```

ì›ê²© í„°ë¯¸ë„ì—ì„œ í”„ë¡œê·¸ëž¨ ì‹¤í–‰ í›„ ì—°ê²°ì„ ì¢…ë£Œí•˜ë”ë¼ë„ í”„ë¡œê·¸ëž¨ì´ ì¢…ë£Œë˜ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•´ì„œ `nohup`ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ ìžˆìŠµë‹ˆë‹¤. í‘œì¤€ ì¶œë ¥ê³¼ ì—ëŸ¬ë¥¼ ë³„ë„ì˜ íŒŒì¼ì— ì €ìž¥í•˜ë©° ë°±ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤.

```bash
nohup python -m smtm --mode 3 --demo 1 > nohup.out 2> nohup.err < /dev/null &
```

## Code Lab
- [ì‹œë®¬ë ˆì´ì…˜ Code Lab](https://smtm.msalt.net/codelab/smtm-simulation/)
- [ëª¨ì˜ íˆ¬ìž Code Lab](https://smtm.msalt.net/codelab/smtm-demo/)

## ê´€ë ¨ ë„ì„œ

[![smtm-book](https://user-images.githubusercontent.com/9311990/157685437-dcedd2c0-9f0c-400c-a3d4-017354279b60.png)](http://www.kyobobook.co.kr/product/detailViewKor.laf?mallGb=KOR&ejkGb=KOR&barcode=9788997924967)
